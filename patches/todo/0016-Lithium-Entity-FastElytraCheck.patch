From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: IPECTER <ipectert@gmail.com>
Date: Thu, 27 Oct 2022 13:56:21 +0900
Subject: [PATCH] Lithium-Entity-FastElytraCheck

Mirai - etil2jz - GPL 3.0
Lithium - CaffeineMC  - GPL 3.0

diff --git a/src/main/java/com/github/ipecter/fusion/FusionWorldConfig.java b/src/main/java/com/github/ipecter/fusion/FusionWorldConfig.java
index aac84aa56e52a6410fbae6380172df1995bd4911..bc0d8d9695c3fdac59b040fd05ac90ba4ccd7070 100644
--- a/src/main/java/com/github/ipecter/fusion/FusionWorldConfig.java
+++ b/src/main/java/com/github/ipecter/fusion/FusionWorldConfig.java
@@ -132,10 +132,12 @@ public class FusionWorldConfig {
 
     public boolean lithiumEnable = true;
     public boolean lithiumCollectionsTileEntityTickers = true;
+    public boolean lithiumEntityFastElytraCheck = true;
 
     private void lithiumConfig() {
         lithiumEnable = getBoolean("lithium.enable", lithiumEnable);
         lithiumCollectionsTileEntityTickers = getBoolean("lithium.collections.tile-entity-tickers", lithiumCollectionsTileEntityTickers) && lithiumEnable;
+        lithiumEntityFastElytraCheck = getBoolean("lithium.entity.fast-elytra-check", lithiumEntityFastElytraCheck) && lithiumEnable;
     }
 
     private void lithiumConfigSetup() {
diff --git a/src/main/java/net/minecraft/world/entity/LivingEntity.java b/src/main/java/net/minecraft/world/entity/LivingEntity.java
index 61a162007b1773ca707d88972d0fcda2c98c5614..a94796d9904d736f306054dad8d0da28547ae8c3 100644
--- a/src/main/java/net/minecraft/world/entity/LivingEntity.java
+++ b/src/main/java/net/minecraft/world/entity/LivingEntity.java
@@ -3541,6 +3541,8 @@ public abstract class LivingEntity extends Entity {
     }
 
     private void updateFallFlying() {
+		if(this.level.fusionConfig.lithiumEntityFastElytraCheck && !this.isFallFlying()) return; // Fusion - Lithium: Entity Fast Elytra Check
+
         boolean flag = this.getSharedFlag(7);
 
         if (flag && !this.onGround && !this.isPassenger() && !this.hasEffect(MobEffects.LEVITATION)) {
